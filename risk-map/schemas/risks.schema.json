{
  "$id": "risks.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CoSAI-RM Risks Schema",
  "description": "Schema for validating YAML-based risks definition",
  "type": "object",
  "properties": {
    "title": {"type": "string"},
    "description": {"$ref": "riskmap.schema.json#/definitions/utils/text"},
    "risks": {
      "type": "array",
      "items": {"$ref": "#/definitions/risk"}
    }
  },
  "required": ["title", "description", "risks"],
  "definitions": {
    "risk": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "enum": ["ASC", "ADI", "COV", "DMS", "DP", "EBM", "EDH", "EDW", "FLP", "IIC", "IMO", "ISD", "MDT", "MEV", "MLD", "MRE", "MST", "MXF", "ORH", "PCP", "PIJ", "RA", "RVP", "SDD", "UTD"]
        },
        "title": {"type": "string"},
        "shortDescription": {"$ref": "riskmap.schema.json#/definitions/utils/text"},
        "longDescription": {"$ref": "riskmap.schema.json#/definitions/utils/text"},
        "personas": {
          "type": "array",
          "items": {"$ref": "personas.schema.json#/definitions/persona/properties/id"}
        },
        "tourContent": {
          "type": "object",
          "properties": {
            "introduced": {"$ref": "riskmap.schema.json#/definitions/utils/text"},
            "exposed": {"$ref": "riskmap.schema.json#/definitions/utils/text"},
            "mitigated": {"$ref": "riskmap.schema.json#/definitions/utils/text"}
          }
        },
        "controls": {
          "type": "array",
          "items": {"$ref": "controls.schema.json#/definitions/control/properties/id"}
        },
        "examples": {"$ref": "riskmap.schema.json#/definitions/utils/text"},
        "relevantQuestions": {
          "type": "array",
          "items": {"type": "string"}
        }
      },
      "required": ["id", "title", "shortDescription", "longDescription", "personas", "controls"]
    }
  }
}
